{
  "experiment": {
    "name": "cytonucs_stardist_hela_3d",
    "use_comet": false,
    "comet_api_key": "YOUR_API_KEY",
    "comet_project": "cytonucs-stardist",
    "comet_workspace": "YOUR_WORKSPACE"
  },

  "data": {
    "dataset_dir": "/NAS/mmaiurov/Datasets/CytoNucs_Hela/",
    "validation_images": [
      "20221107_HeLa_MRC_24hLN_DLS Acquire 2_007_Target_Lng_z00_ch00.tif"
    ],
    "skip_images": [],
    "pool_size": null,
    "repool_freq": 10
  },

  "preprocessing": {
    "run_preprocessing": true,
    "raw_images_dir": "/NAS/mmaiurov/Datasets/Hela_MRC/images",
    "raw_nucleus_masks_dir": "/NAS/mmaiurov/Datasets/Hela_MRC/nucleus_masks",
    "raw_cytoplasm_masks_dir": "/NAS/mmaiurov/Datasets/Hela_MRC/cytoplasm_masks",
    "output_dir": "/NAS/mmaiurov/Datasets/CytoNucs_Hela/",
    "test_split": 0.1,
    "val_split": 0.1,
    "compute_assignments": true,
    "seed": 42
  },

  "model": {
    "ndim": 3,
    "n_rays": 128,
    "anisotropy": null,
    "grid": null,
    "backbone": "unet",
    "shared_encoder": true,
    "n_channel_in": 1,
    "use_gpu": false
  },

  "training": {
    "train_patch_size": [12, 96, 96],
    "train_batch_size": 4,
    "train_epochs": 400,
    "steps_per_epoch": 100,
    "initial_learning_rate": 0.0003,
    "lr_decay_steps": 700,
    "lr_decay_rate": 0.5,
    "lr_staircase": true
  },

  "loss_weights": {
    "lambda_prob_nucleus": 1.0,
    "lambda_dist_nucleus": 1.0,
    "lambda_prob_cytoplasm": 1.0,
    "lambda_dist_cytoplasm": 1.0,
    "lambda_containment": 0.5,
    "lambda_wbr": 0.3,
    "lambda_consistency": 0.0,
    "enable_consistency": false
  },

  "loss_params": {
    "containment_margin": 2.0,
    "max_assignment_distance": 5.0,
    "wbr_sigma": 2.0
  },

  "augmentation": {
    "enable": true,
    "flip_prob": 0.5,
    "rotation_yx": true,
    "intensity_range": [0.6, 2.0],
    "intensity_offset": [-0.2, 0.2],
    "gamma_range": [0.9, 1.1],
    "noise_sigma": 0.01,
    "zoom_range": null,
    "blur_sigma_range": null
  },

  "evaluation": {
    "eval_dice_every": 5,
    "optimize_thresholds": true,
    "prob_thresh_range": [0.3, 0.4, 0.5, 0.6, 0.7],
    "nms_thresh_range": [0.3, 0.4, 0.5, 0.6],
    "compute_jtpr": true,
    "save_predictions": true
  },

  "output": {
    "basedir": "models",
    "save_best_dice": true,
    "save_every_n_epochs": 10,
    "save_history": true
  }
}